<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Alison Presmanes Hill" />


<title>CONJ620: CM 4.4</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CONJ 620</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="cm.html">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Class Meetings
  </a>
</li>
<li>
  <a href="due.html">
    <span class="fa fa-calendar-check"></span>
     
    Due Dates
  </a>
</li>
<li>
  <a href="https://distracted-bhabha-a42d09.netlify.com">
    <span class="fa fa-key"></span>
     
    Grades
  </a>
</li>
<li>
  <a href="https://www.datacamp.com/enterprise/conj-620-introduction-to-biostatistics-for-the-basic-sciences-data-wrangling-analysis-communication">
    <span class="fa fa-user-ninja"></span>
     
    DataCamp
  </a>
</li>
<li>
  <a href="https://sakai.ohsu.edu/portal/site/CONJ-620-1-2040-Su18">
    <span class="fa fa-university"></span>
     
    Sakai
  </a>
</li>
<li>
  <a href="https://gitter.im/conj620/Lobby?utm_source=share-link&amp;utm_medium=link&amp;utm_campaign=share-link">
    <span class="fa fa-comments"></span>
     
    Gitter Chat
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-cogs"></span>
     
    About
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">CONJ620: CM 4.4</h1>
<h3 class="subtitle"><em>Post-hoc tests &amp; two-way ANOVA</em></h3>
<h4 class="author"><em>Alison Presmanes Hill</em></h4>

</div>


<div id="logistics" class="section level1">
<h1>Logistics</h1>
<ul>
<li>A complete knitted <code>html</code> file is due on Sakai by Tuesday September 11 (2:30pm).</li>
<li>This lab is based on the assigned reading that includes <a href="https://www.nature.com/articles/nmeth.3005">this article on ANOVA in Nature Points of Significance</a>.</li>
<li>Also, this <a href="http://blog.minitab.com/blog/adventures-in-statistics-2/understanding-analysis-of-variance-anova-and-the-f-test">blog post</a> is very well-written and helpful.</li>
</ul>
</div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>In the last <a href="cm043.html">lab</a>, we did an ANOVA by hand, then you did a linear regression using <code>lm</code> and (hopefully) saw that a one-way ANOVA and a simple linear regression <em>are equivalent</em>. Both are based on the general linear model, and rely on calculating statistics based on sums of squares.</p>
<div class="figure">
<img src="slides/images/anova-by-hand-board.JPG" />

</div>
<p>In this lab, we'll start with post-hoc tests and p-value corrections, leading up to a two-way ANOVA where we include <em>two</em> predictor or independent variables. Get excited!</p>
</div>
<div id="packages" class="section level1">
<h1>Packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(janitor)
<span class="kw">library</span>(moderndive)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(multcomp)
select &lt;-<span class="st"> </span>dplyr<span class="op">::</span>select <span class="co"># deals with the namespace conflict</span></code></pre></div>
</div>
<div id="get-the-data" class="section level1">
<h1>Get the data</h1>
<p>This is all the same as in the previous <a href="cm043.html">lab</a>.</p>
<blockquote>
<p>&quot;A univariate [read: one response/outcome variable] ANOVA was conducted investigating the impact of the between-subjects factors [read: all levels of factors are measured from independent samples] of age (4: 3–4 years, 5–6 years, 7–8 years, 9–11 years), number of resources (2: 12 or 30 stickers), number of recipients (2: 1 or 2 anonymous recipients), and gender (2: female, male) on the proportion of resources shared.&quot;</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create variable to store url</span>
link &lt;-<span class="st"> &quot;https://dataverse.harvard.edu/api/access/datafile/2712105&quot;</span>

<span class="co"># read in column names only</span>
sticker_names &lt;-<span class="st"> </span>link <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">read_tsv</span>(<span class="dt">n_max =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># default: col_names = TRUE</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">stickersgiven =</span> <span class="st">&#39;absolutenumberofstickersgiven(Conditions1or3:Outof12;Conditions2or4:Outof30)&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">names</span>()

<span class="co"># read in data, set column names</span>
stickers &lt;-<span class="st"> </span>link <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">read_tsv</span>(<span class="dt">skip =</span> <span class="dv">2</span>, <span class="dt">col_names =</span> sticker_names) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">clean_names</span>()

<span class="co"># clean it up a bit</span>
<span class="co"># in class we got errors, so we commented out two lines</span>
stickers_clean &lt;-<span class="st"> </span>stickers <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_stickers =</span> <span class="kw">case_when</span>(
    number_stickers <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">12</span>,
    number_stickers <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">30</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>(subject_number <span class="op">==</span><span class="st"> </span><span class="dv">263</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(gender <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#mutate(condition = if_else(subject_number == 263, 3L, condition)) %&gt;% </span>
<span class="st">  </span><span class="co">#mutate(num_stickers = if_else(subject_number == 263, 30L, num_stickers)) %&gt;% </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_given =</span> <span class="kw">round</span>(stickersgiven <span class="op">/</span><span class="st"> </span>num_stickers, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>percent_given_outof100percent, <span class="op">-</span>number_stickers) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">giveornot =</span> <span class="kw">case_when</span>(
    prop_given <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,
    prop_given <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)) 

givers &lt;-<span class="st"> </span>stickers_clean <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(giveornot <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_groups =</span> <span class="kw">as.factor</span>(agegroups),
         <span class="dt">gender =</span> <span class="kw">as.factor</span>(gender))</code></pre></div>
</div>
<div id="plot-the-group-means" class="section level1">
<h1>Plot the group means</h1>
<p>Use <code>ggplot2</code> to make a plot that allows you to visualize the mean proportion of stickers given by age group for the givers, and allows you to see the spread as well. Think about whether you can also include the actual observed data points as recommended by <a href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1002128">Tracy Weissberger</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(givers, <span class="kw">aes</span>(<span class="dt">x =</span> age_groups, <span class="dt">y =</span> prop_given, 
                   <span class="dt">fill =</span> age_groups, <span class="dt">colour =</span> age_groups)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">binaxis =</span> <span class="st">&quot;y&quot;</span>, 
    <span class="dt">binwidth =</span> .<span class="dv">01</span>, <span class="dt">binpositions =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">stackratio =</span> .<span class="dv">8</span>, <span class="dt">dotsize =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> .<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">fun.ymin =</span> mean, 
    <span class="dt">fun.ymax =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;crossbar&quot;</span>, <span class="dt">width =</span> <span class="fl">0.75</span>, <span class="dt">lwd =</span> .<span class="dv">75</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;age group&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;proportion of stickers given&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(prop_given)), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) </code></pre></div>
<p><img src="cm044_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggbeeswarm)
<span class="kw">ggplot</span>(givers, <span class="kw">aes</span>(<span class="dt">x =</span> age_groups, <span class="dt">y =</span> prop_given, 
                   <span class="dt">fill =</span> age_groups, <span class="dt">colour =</span> age_groups)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_beeswarm</span>(<span class="dt">alpha =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;age group&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;proportion of stickers given&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(prop_given)), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) </code></pre></div>
<p><img src="cm044_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Also make a plot of the means with standard error bars colored by gender, following help <a href="http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/">here</a> (no bar graphs/dynamite plots)!</p>
<p>Also see this <a href="https://apreshill.github.io/data-vis-labs-2018/04-distributions.html#14_plotting_summary_statistics">link</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(givers, <span class="kw">aes</span>(<span class="dt">x =</span> age_groups, <span class="dt">y =</span> prop_given, <span class="dt">colour =</span> gender)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="kw">aes</span>(<span class="dt">group =</span> gender)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> mean_cl_boot, <span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;age_group&quot;</span>, 
       <span class="dt">y =</span> <span class="st">&quot;proportion of stickers given&quot;</span>,
       <span class="dt">colour =</span> <span class="st">&quot;gender&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="cm044_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="post-hoc-testing" class="section level1">
<h1>Post-hoc testing</h1>
<p>If you feel happy to assume that the variances of the response/outcome/dependent variable are equal across groups, you can use a method for comparing the individual groups called Tukey's Honestly Significant Difference. The way to do this contrast procedure is to use a package called <code>multcomp</code>. Let's start with the <code>lm</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sticker_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(prop_given <span class="op">~</span><span class="st"> </span>age_groups, <span class="dt">data =</span> givers)
<span class="kw">anova</span>(sticker_lm)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: prop_given
            Df  Sum Sq Mean Sq F value      Pr(&gt;F)    
age_groups   3  1.4825 0.49418  11.795 0.000000236 ***
Residuals  325 13.6163 0.04190                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sticker_mcp &lt;-<span class="st"> </span><span class="kw">glht</span>(sticker_lm, <span class="kw">mcp</span>(<span class="dt">age_groups =</span> <span class="st">&quot;Tukey&quot;</span>))
<span class="kw">confint</span>(sticker_mcp)</code></pre></div>
<pre><code>
     Simultaneous Confidence Intervals

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = prop_given ~ age_groups, data = givers)

Quantile = 2.5842
95% family-wise confidence level
 

Linear Hypotheses:
           Estimate lwr      upr     
2 - 1 == 0  0.02487 -0.05620  0.10593
3 - 1 == 0  0.11434  0.03368  0.19499
4 - 1 == 0  0.17579  0.08746  0.26411
3 - 2 == 0  0.08947  0.01148  0.16746
4 - 2 == 0  0.15092  0.06502  0.23682
4 - 3 == 0  0.06145 -0.02406  0.14697</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sticker_mcp, <span class="dt">test =</span> <span class="kw">univariate</span>()) <span class="co">#unadjusted p values</span></code></pre></div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = prop_given ~ age_groups, data = givers)

Linear Hypotheses:
           Estimate Std. Error t value    Pr(&gt;|t|)    
2 - 1 == 0  0.02487    0.03137   0.793    0.428567    
3 - 1 == 0  0.11434    0.03121   3.663    0.000291 ***
4 - 1 == 0  0.17579    0.03418   5.143 0.000000468 ***
3 - 2 == 0  0.08947    0.03018   2.964    0.003256 ** 
4 - 2 == 0  0.15092    0.03324   4.540 0.000007924 ***
4 - 3 == 0  0.06145    0.03309   1.857    0.064210 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
(Univariate p values reported)</code></pre>
<p>You can also plot these with base R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sticker_mcp)</code></pre></div>
<p><img src="cm044_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>For which age groups is the difference in mean <code>prop_given</code> significantly different from zero?</p>
<p>Alternatively, you can do post-hoc pairwise t-tests. These are not the same as normal t-tests!</p>
<p><span class="math display">\[t = \frac{\bar{x}_i - \bar{x}_j}{\sqrt{MS_{residual} (\frac{1}{n_i} + \frac{1}{n_j})}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(givers, <span class="kw">pairwise.t.test</span>(prop_given, age_groups,
                             <span class="dt">paired =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  prop_given and age_groups 

  1         2         3     
2 0.4286    -         -     
3 0.0012    0.0098    -     
4 0.0000028 0.0000396 0.1284

P value adjustment method: holm </code></pre>
</div>
<div id="adjust-p-values" class="section level1">
<h1>Adjust p-values</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sticker_mcp, <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>)) <span class="co">#p value adjustment</span></code></pre></div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = prop_given ~ age_groups, data = givers)

Linear Hypotheses:
           Estimate Std. Error t value   Pr(&gt;|t|)    
2 - 1 == 0  0.02487    0.03137   0.793    1.00000    
3 - 1 == 0  0.11434    0.03121   3.663    0.00174 ** 
4 - 1 == 0  0.17579    0.03418   5.143 0.00000281 ***
3 - 2 == 0  0.08947    0.03018   2.964    0.01954 *  
4 - 2 == 0  0.15092    0.03324   4.540 0.00004754 ***
4 - 3 == 0  0.06145    0.03309   1.857    0.38526    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
(Adjusted p values reported -- bonferroni method)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">p.adjust</span>(<span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">049</span>, .<span class="dv">01</span>), <span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</code></pre></div>
<pre><code>[1] 0.150 0.147 0.030</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">p.adjust</span>(<span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">049</span>, .<span class="dv">01</span>), <span class="dt">method =</span> <span class="st">&quot;holm&quot;</span>)</code></pre></div>
<pre><code>[1] 0.098 0.098 0.030</code></pre>
</div>

<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="by-nc.png" height="400" width="65"/></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
