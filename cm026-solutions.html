<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Alison Hill" />


<title>CONJ620: CM 2.6</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CONJ 620</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="cm.html">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Class Meetings
  </a>
</li>
<li>
  <a href="due.html">
    <span class="fa fa-calendar-check"></span>
     
    Due Dates
  </a>
</li>
<li>
  <a href="https://distracted-bhabha-a42d09.netlify.com">
    <span class="fa fa-key"></span>
     
    Grades
  </a>
</li>
<li>
  <a href="https://www.datacamp.com/enterprise/conj-620-introduction-to-biostatistics-for-the-basic-sciences-data-wrangling-analysis-communication">
    <span class="fa fa-user-ninja"></span>
     
    DataCamp
  </a>
</li>
<li>
  <a href="https://sakai.ohsu.edu/portal/site/CONJ-620-1-2040-Su18">
    <span class="fa fa-university"></span>
     
    Sakai
  </a>
</li>
<li>
  <a href="https://gitter.im/conj620/Lobby?utm_source=share-link&amp;utm_medium=link&amp;utm_campaign=share-link">
    <span class="fa fa-comments"></span>
     
    Gitter Chat
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-cogs"></span>
     
    About
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">CONJ620: CM 2.6</h1>
<h3 class="subtitle"><em>Integrative Lab</em></h3>
<h4 class="author"><em>Alison Hill</em></h4>

</div>


<p><strong>Self-Assessment</strong></p>
<ul style="color:cadetblue">
<p>How to:</p>
<ul>
<li><p>Start with your initial submission, and save it as a new file. Then add a sub-section to each of the sections with content called “Self-Assessment”.</p></li>
<li><p>You may want to add color formatting to further highlight the self-assessment section. You can change the color of the font by using <code>&lt;span style=&quot;color:deeppink&quot;&gt;</code> <span style="color:deeppink">span styles like this</span> <code>&lt;/span&gt;</code>.</p></li>
<li><p>If you want to change the color of a bulleted list, change <code>span</code> to <code>ul</code> and use the same method (pick any <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">color</a>).</p></li>
<li>My code is provided here so that you can problem solve- if you need to copy and paste, do so in your self-assessment section, but you’ll need to include narrative including attribution and reflection on <em>what</em> part of that code chunk you struggled with and <em>why</em>.</li>
</ul>
</ul>
<div id="overview" class="section level1">
<h1><span class="header-section-number">1</span> Overview</h1>
<p>The goal of this lab is to carefully, thoroughly, and thoughtfully conduct an linear regression analysis. You are also asked to communicate clearly about the steps in your analysis process with others, by sharing your R code, output, and narrative. As such, your code cannot “stand alone”- it is meant to complement / enhance / support your narrative. As with our previous <a href="cm016.html">integrative lab</a>, this lab will be due in two stages:</p>
<ol style="list-style-type: decimal">
<li>A complete knitted <code>html</code> file is due on Sakai by Thursday August 9th at 2:30pm.</li>
<li>After class on August 9th, you’ll be provided with a code key. You are asked to review your initial submission, and reflect on your own code/narrative after reviewing the key thoroughly. Your self-assessment is due on Sakai by beginning of class Thursday August 16th (2:30pm).</li>
</ol>
<p>Using the key, your self-assessment should include even <strong>more</strong> narrative; where you made mistakes, you must discuss and analyze where you went wrong, and correct them without copying/pasting directly from the key (this typically means that you need to include more narrative than we provide in the key). A good self-assessment will include:</p>
<ul>
<li>Assessment of the accuracy and completeness of your “initial solutions”</li>
<li>Correct worked solutions with some discussion and analysis of why your initial solution was incorrect, and reflection on the source of your confusion (if you got an answer correct, this is not necessary)</li>
<li>Attributions as appropriate to other students who helped you, or other sources such as lecture notes, readings, online resources, etc. that helped you</li>
</ul>
</div>
<div id="logistics" class="section level1">
<h1><span class="header-section-number">2</span> Logistics</h1>
<p>You will use R Markdown to construct your analysis report. You’ll submit your work as an html file knit from your <code>.Rmd</code> file (please leave the default code chunk options for <code>eval = TRUE</code> and <code>echo = TRUE</code>). Your lab should serve as your own personal cheatsheet in the future for regression analyses. Give yourself the cheatsheet you deserve!</p>
<p>For all things, code and narrative, if you’re dissatisfied with a result, discuss the problem, what you’ve tried and move on (remember my 30-minute rule). You’ll need this loaded at the top:</p>
<pre class="r"><code>library(tidyverse) # all the good stuff
library(readxl) # for reading in xlsx files
library(janitor) # for clean_names
library(knitr) # for kable
library(moderndive) # for getting tables
library(corrr) # for correlation matrix
library(skimr) # for skim
library(GGally) # for ggpairs
library(broom) # for pulling out model results</code></pre>
</div>
<div id="the-data" class="section level1">
<h1><span class="header-section-number">3</span> The Data</h1>
<p>You will work with an open access dataset from a publication in PLOS ONE titled: <a href="https://dx.doi.org/10.1371%2Fjournal.pone.0104825"><em>Vitamin D Status among Thai School Children and the Association with 1,25-Dihydroxyvitamin D and Parathyroid Hormone Levels</em></a>. The data is available as an excel file on <a href="https://datadryad.org/resource/doi:10.5061/dryad.7763s/1">Data Dryad</a>, where you can download the <code>.xlsx</code> file.</p>
<p>You could also access the data through a package called <a href="https://github.com/ropensci/rdryad"><code>rdryad</code></a>, from <a href="https://ropensci.org">ROpenSci</a>, which allows you to access the DataDryad Application Programming Interface (API) from within R. To go this route, follow my code:</p>
<pre class="r"><code># install.packages(&quot;rdryad&quot;)
# install.packages(&quot;purrr&quot;)
library(rdryad) # to access the API
library(readxl) # to read in the xlsx file
library(purrr) # for 1 function: pluck!
path_to_xlsx &lt;- dryad_fetch(dryad_files(doi = &#39;10.5061/dryad.7763s/1&#39;)) %&gt;% 
  pluck(1)
vitd &lt;- read_xlsx(path_to_xlsx, sheet = 1)</code></pre>
<p>I’m also going to recommend you use the <code>janitor::clean_names</code> function, because some of these variable names start with an underscore and therefore will always need to be referenced surrounded by backticks.</p>
<pre class="r"><code>library(janitor)
vitd &lt;- vitd %&gt;% 
  clean_names()
glimpse(vitd)</code></pre>
<pre><code>Observations: 537
Variables: 19
$ id          &lt;dbl&gt; 101, 102, 104, 105, 106, 107, 108, 110, 112, 113, ...
$ sex         &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, ...
$ ageyears    &lt;dbl&gt; 7.749487, 7.040383, 7.289528, 7.251198, 6.845995, ...
$ height      &lt;dbl&gt; 121.80, 120.40, 117.00, 115.60, 113.30, 121.60, 12...
$ weight      &lt;dbl&gt; 20.0, 18.1, 19.6, 19.3, 17.0, 23.8, 24.1, 23.1, 22...
$ bmi         &lt;dbl&gt; 13.48141, 12.48606, 14.31807, 14.44248, 13.24308, ...
$ zwfa        &lt;dbl&gt; -1.29, -1.47, -1.09, -1.17, -2.18, -0.28, -0.07, -...
$ underweight &lt;chr&gt; &quot;not underweight&quot;, &quot;not underweight&quot;, &quot;not underwe...
$ zbfa        &lt;dbl&gt; -1.45, -2.24, -0.75, -0.65, -1.88, 0.28, -0.48, -1...
$ wasted      &lt;chr&gt; &quot;not wasted&quot;, &quot;wasted&quot;, &quot;not wasted&quot;, &quot;not wasted&quot;...
$ zhfa        &lt;dbl&gt; -0.58, -0.12, -0.98, -1.20, -1.45, -0.77, 0.34, -0...
$ stunted     &lt;chr&gt; &quot;not stunted&quot;, &quot;not stunted&quot;, &quot;not stunted&quot;, &quot;not ...
$ period      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ ifyeswhen   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ school      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
$ baseline_ca &lt;dbl&gt; NA, NA, NA, 57.6876, NA, NA, 290.4152, 131.2554, N...
$ pth         &lt;dbl&gt; 66.7, 55.1, 29.5, 48.9, 20.7, 23.9, 23.4, 24.7, 33...
$ x25d        &lt;dbl&gt; 72.2, 73.4, 64.6, 73.6, 88.5, 85.8, NA, 75.2, 82.9...
$ x125d       &lt;dbl&gt; 265, 144, 320, 245, 251, 206, 200, 205, 254, 223, ...</code></pre>
<p>That is better! You are ready to start exploring the <code>vitd</code> data.</p>
</div>
<div id="your-mission" class="section level1">
<h1><span class="header-section-number">4</span> Your Mission</h1>
<p>We’ll conduct a linear regression analysis to examine the impact of age, and its interaction with sex, along with height-for-age Z score on serum 25(OH)D concentrations (a measure of vitamin D levels). If you read in the data using <code>rdryad</code>, you can also download the codebook like this:</p>
<pre class="r"><code>codebook &lt;- read_xlsx(path_to_xlsx, sheet = 2)</code></pre>
<p>The relevant variables you will need are:</p>
<pre class="r"><code>lm_vars &lt;- c(&quot;sex&quot;, &quot;_zhfa&quot;, &quot;ageyears&quot;, &quot;_25D&quot;)
codebook %&gt;% 
  filter(Variable %in% lm_vars) %&gt;% 
  knitr::kable()</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Unit or coding where applicable
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:left;">
Sex of child participant
</td>
<td style="text-align:left;">
F=female, M=male
</td>
</tr>
<tr>
<td style="text-align:left;">
ageyears
</td>
<td style="text-align:left;">
Age of child participant
</td>
<td style="text-align:left;">
YEARS
</td>
</tr>
<tr>
<td style="text-align:left;">
_zhfa
</td>
<td style="text-align:left;">
Height-for-age z-score
</td>
<td style="text-align:left;">
Standard deviation (SD)
</td>
</tr>
<tr>
<td style="text-align:left;">
_25D
</td>
<td style="text-align:left;">
Serum 25-hydroxyvitamin D concentrations
</td>
<td style="text-align:left;">
nmol/L
</td>
</tr>
</tbody>
</table>
<p><br> Please note that the variable names in the codebook won’t exactly match those in your data if you use <code>janitor::clean_names()</code>! All <code>_</code> will be replaced by <code>x</code> so that you don’t have to type backticks in your later R code.</p>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1><span class="header-section-number">5</span> Exploratory Data Analysis</h1>
<p>Conduct a thorough EDA of the four variables defined above in the vitamin D dataset. Recall that a <a href="http://moderndive.netlify.com/6-regression.html#model1EDA">new exploratory data analysis</a> involves three things:</p>
<ul>
<li>Looking at the raw values.
<ul>
<li><code>dplyr::glimpse()</code></li>
</ul></li>
<li>Computing summary statistics of the variables of interest.
<ul>
<li><code>skimr::skim()</code></li>
<li><code>corrr::correlate()</code></li>
</ul></li>
<li>Creating informative visualizations.
<ul>
<li><code>ggplot2::ggplot()</code>
<ul>
<li><code>geom_histogram()</code> or <code>geom_density()</code> for numeric continuous variables</li>
<li><code>geom_bar()</code> or <code>geom_col()</code> for categorical variables</li>
</ul></li>
<li><code>GGally::ggpairs()</code>
<ul>
<li>Note that you can add transparency to points/density plots in the <code>aes</code> call, for example: <code>aes(colour = sex, alpha = 0.7)</code></li>
</ul></li>
</ul></li>
</ul>
<p>You may wish to have a level 1 header (<code>#</code>) for your EDA, then use level 2 sub-headers (<code>##</code>) to make sure you cover all three EDA bases. Remember from our previous <a href="cm024.html">EDA for regression lab</a>, <strong>at a minimum</strong> you should answer these questions:</p>
<ul>
<li>How many variables/columns?</li>
<li>How many rows/observations?</li>
<li>Which variables are numbers?</li>
<li>Which are categorical variables (numeric or character variables with variables that have a fixed and known set of possible values; aka <a href="https://stats.idre.ucla.edu/r/modules/factor-variables/">factor</a> variables)?</li>
<li>Complete this sentence: “There is one row per…”</li>
<li>What are the correlations between variables? Does each scatterplot support a linear relationship between variables? Do any of the correlations appear to be conditional on the value of a categorical variable (like <code>sex</code>)?</li>
</ul>
<p>At this stage, you may also find you want to use <code>filter</code>, <code>mutate</code>, <code>arrange</code>, <code>select</code>, or <code>count</code>. Let your questions lead you!</p>
<div id="eda-solutions" class="section level2">
<h2><span class="header-section-number">5.1</span> EDA Solutions</h2>
<pre class="r"><code>vitd %&gt;% 
  count(id, sort = TRUE)</code></pre>
<pre><code># A tibble: 537 x 2
      id     n
   &lt;dbl&gt; &lt;int&gt;
 1   101     1
 2   102     1
 3   104     1
 4   105     1
 5   106     1
 6   107     1
 7   108     1
 8   110     1
 9   112     1
10   113     1
# ... with 527 more rows</code></pre>
<pre class="r"><code>small_vitd &lt;- vitd %&gt;% 
  select(ageyears, sex, x25d, zhfa)
glimpse(small_vitd)</code></pre>
<pre><code>Observations: 537
Variables: 4
$ ageyears &lt;dbl&gt; 7.749487, 7.040383, 7.289528, 7.251198, 6.845995, 7.7...
$ sex      &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;...
$ x25d     &lt;dbl&gt; 72.2, 73.4, 64.6, 73.6, 88.5, 85.8, NA, 75.2, 82.9, 7...
$ zhfa     &lt;dbl&gt; -0.58, -0.12, -0.98, -1.20, -1.45, -0.77, 0.34, -0.33...</code></pre>
<pre class="r"><code>skim(small_vitd)</code></pre>
<pre><code>Skim summary statistics
 n obs: 537 
 n variables: 4 

Variable type: character 
 variable missing complete   n min max empty n_unique
      sex       0      537 537   1   1     0        2

Variable type: numeric 
 variable missing complete   n  mean    sd    p0   p25   p50   p75   p100
 ageyears       0      537 537  9.89  1.69  6.16  8.38  9.95 11.26  14.03
     x25d       8      529 537 74.31 15.39 36.1  64.3  73.6  84.3  127   
     zhfa       0      537 537 -0.98  0.84 -3.35 -1.57 -1    -0.36   1.86
     hist
 ▁▇▇▇▇▇▅▁
 ▁▃▆▇▅▂▁▁
 ▁▂▆▇▆▃▁▁</code></pre>
<pre class="r"><code>small_vitd %&gt;% 
  group_by(sex) %&gt;% 
  skim()</code></pre>
<pre><code>Skim summary statistics
 n obs: 537 
 n variables: 4 
 group variables: sex 

Variable type: numeric 
 sex variable missing complete   n  mean    sd    p0   p25   p50   p75
   F ageyears       0      271 271  9.83  1.74  6.16  8.3   9.86 11.18
   F     x25d       3      268 271 68.08 13.19 36.9  58.68 67.35 76.6 
   F     zhfa       0      271 271 -0.9   0.8  -3.15 -1.46 -0.86 -0.33
   M ageyears       0      266 266  9.94  1.63  6.85  8.48  9.98 11.3 
   M     x25d       5      261 266 80.71 14.87 36.1  71.6  79.5  88.8 
   M     zhfa       0      266 266 -1.06  0.88 -3.35 -1.67 -1.13 -0.47
   p100     hist
  13.71 ▂▇▇▇▇▇▆▁
 113    ▁▅▆▇▅▂▁▁
   1.39 ▁▂▆▇▇▅▂▁
  14.03 ▃▇▅▆▇▆▃▁
 127    ▁▂▃▇▆▃▁▁
   1.86 ▁▃▆▇▅▃▁▁</code></pre>
<pre class="r"><code>ggpairs(small_vitd, aes(colour = sex, alpha = 0.7),
        columns = c(&quot;x25d&quot;, &quot;ageyears&quot;, &quot;zhfa&quot;))</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-6-1.png" width="2100" /></p>
<p>Note: to change color of text in a markdown list, use this command before your list: <code>&lt;ul style=&quot;color:cadetblue&quot;&gt;</code> and this command at the end of the list <code>&lt;/ul&gt;</code>.</p>
<ul style="color:cadetblue">
<ul>
<li>How many variables/columns?
<ul>
<li>4 (I selected just the variables I need)</li>
</ul></li>
<li>How many rows/observations?
<ul>
<li>537, but due to missing data, the <code>lm</code> will only use 529 observations</li>
</ul></li>
<li>Which variables are numbers?
<ul>
<li><code>ageyears</code> is a number, with 0 missing values- range of 6.2 to 14</li>
<li><code>x25d</code> is a number, with 8 missing values- range of 36 to 127</li>
<li><code>zhfa</code> is a number, with 0 missing values- range of -3.4 to 1.9</li>
</ul></li>
<li>Which are categorical variables (numeric or character variables with variables that have a fixed and known set of possible values; aka <a href="https://stats.idre.ucla.edu/r/modules/factor-variables/">factor</a> variables)?
<ul>
<li><code>sex</code> is a categorical variable- the codebook states that <code>F</code> = Female, <code>M</code> = Male. This means if I treat this variable as a factor, female will be the default reference level of that factor because it comes first alphabetically</li>
</ul></li>
<li>Complete this sentence: “There is one row per…”
<ul>
<li>There is one row per study participant</li>
</ul></li>
<li>What are the correlations between variables? Does each scatterplot support a linear relationship between variables? Do any of the correlations appear to be conditional on the value of a categorical variable (like <code>sex</code>)?
<ul>
<li>The correlation between vitamin d levels and age looks like it may depend on sex- there is a negative correlation for females (-0.4) but not for males (-0.0086). For girls, it seems like vitamin d levels decrease as age increases, although the linearity of this association is difficult to see from the bivariate scatterplot.</li>
<li>Height-for-age z-scores do not seem to be meaningfully correlated with vitamin d or age, for females or males.</li>
</ul></li>
</ul>
</ul>
</div>
</div>
<div id="regression-modeling" class="section level1">
<h1><span class="header-section-number">6</span> Regression Modeling</h1>
<p>Fit a multiple regression model to predict serum 25(OH)D concentrations (<code>x25d</code> if you used <code>janitor::clean_names()</code>; <code>_25D</code> if you did not) and get the regression table. Your model should include:</p>
<ul>
<li>An intercept term</li>
<li>A coefficient for age in years (<code>ageyears</code>)</li>
<li>A coefficient for sex (<code>sex</code>)</li>
<li>A coefficient for the interaction between age and sex (<code>ageyears:sex</code>)</li>
<li>A coefficient for height-for-age z-scores (<code>zhfa</code> if you used <code>janitor::clean_names()</code>, <code>_zhfa</code> if not)</li>
</ul>
<p>Interpret the output from the regression table (in complete sentences, but you may use bullet points to organize). You may wish to enhance the interpretability of your results by <a href="https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/j.2041-210X.2010.00012.x">mean centering numerical predictor variables</a>.</p>
<p>Some examples:</p>
<ul>
<li>Parallel slopes example <a href="http://moderndive.netlify.com/7-multiple-regression.html#model4table">here</a></li>
<li>Interaction model <a href="http://moderndive.netlify.com/7-multiple-regression.html#model4interactiontable">here</a></li>
</ul>
<p>The authors state: “Specifically, serum 25(OH)D concentrations were 19% higher in males at the mean age (9.9 years).” They also state: “females experienced a…4% decline in serum 25(OH)D levels for each increasing year of age; no decline was seen in male participants with increasing age”. In your narrative, walk through how you would use the numbers in the regression table to arrive at these numbers- are they accurate based on your regression model output?</p>
<div id="regression-modeling-solutions" class="section level2">
<h2><span class="header-section-number">6.1</span> Regression Modeling Solutions</h2>
<pre class="r"><code>small_vitd &lt;- small_vitd %&gt;% 
  mutate(age_ctr = ageyears - mean(ageyears))
dmod &lt;- lm(x25d ~ age_ctr*sex + zhfa, data = small_vitd)
get_regression_table(dmod)</code></pre>
<pre><code># A tibble: 5 x 7
  term         estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept       66.4      1.04      63.7    0        64.3    68.4  
2 age_ctr         -3.09     0.476     -6.49   0        -4.03   -2.15 
3 sexM            12.5      1.18      10.6    0        10.2    14.8  
4 zhfa            -1.73     0.701     -2.47   0.014    -3.10   -0.352
5 age_ctr:sexM     2.96     0.702      4.22   0         1.58    4.34 </code></pre>
<p>The modeling equation for males is: <span class="math display">\[\hat{y}_{male} = 78.9 -.13~\textrm{age_ctr} - 1.73~\textrm{zhfa}\]</span> The modeling equation for females is: <span class="math display">\[\hat{y}_{female} = 66.4 -3.09~\textrm{age_ctr} - 1.73~\textrm{zhfa}\]</span></p>
<ul style="color:cadetblue">
<ul>
<li>Females are treated as the baseline for comparison for no other reason than “female” is alphabetically earlier than “male.” The <span class="math inline">\(b_{male} = 12.5\)</span> is the vertical “bump” that males get in their vitamin d levels. Or more precisely, it is the average difference in vitamin d levels that males get relative to the baseline of females. From <code>skimr</code> output, we can see this is the difference between <span class="math inline">\(\bar{x}_{F}\)</span> = 68 and <span class="math inline">\(\bar{x}_{M}\)</span> = 81 (with some rounding going on here)</li>
<li>We see that females have a lower intercept, and, as they age, they have a more steep associated average decrease in teaching scores: 3.09 vitamin d level units per year as opposed to .13 for males.</li>
<li>Both males and females have the same slope for <code>zhfa</code>. In other words, in this model the associated effect of height is the same for males and females. So for every increase of one unit in height-for-age z-scores, there is on average an associated change of <span class="math inline">\(b_{zhfa}\)</span> = -1.73 (a decrease) in vitamin d levels.</li>
<li>“Specifically, serum 25(OH)D concentrations were 19% higher in males at the mean age (9.9 years).”
<ul>
<li>Because I centered the age variable at the mean age (9.9 years), we can compare the intercepts: <span class="math inline">\((78.9-66.4)/66.4 * 100 = 18.8%\)</span>; so seems right.</li>
</ul></li>
<li>“females experienced a…4% decline in serum 25(OH)D levels for each increasing year of age; no decline was seen in male participants with increasing age”
<ul>
<li>For each increasing year of age, females had 3.09 less units of vitamin d. If we take the mean age level of 66.4: <span class="math inline">\(3.09/66.4 * 100 = 4.65%\)</span>; my math gives me a slightly higher number as a percentage.</li>
</ul></li>
</ul>
</ul>
</div>
</div>
<div id="residual-analysis" class="section level1">
<h1><span class="header-section-number">7</span> Residual Analysis</h1>
<p>Examine the model residuals following using <code>get_regression_points(my_model)</code>. Perform a (raw) residual analysis first with a histogram, faceting by <code>sex</code>. Also look at the residuals as compared to the three predictor variables:</p>
<ul>
<li><span class="math inline">\(x_1\)</span>: numerical explanatory/predictor variable of <code>age</code></li>
<li><span class="math inline">\(x_2\)</span>: categorical explanatory/predictor variable of <code>sex</code></li>
<li><span class="math inline">\(x_3\)</span>: numerical explanatory/predictor variable of height-for-age z-scores (<code>zhfa</code> if you used <code>janitor::clean_names()</code>, <code>_zhfa</code> if not)</li>
</ul>
<p>Explain (a) what you are looking for in the plots, and (b) what you see in the context of assessing how “well” the linear model fits the data.</p>
<p>Some examples:</p>
<ul>
<li>Parallel slopes example <a href="http://moderndive.netlify.com/7-multiple-regression.html#model3residuals">here</a></li>
<li>Interaction model <a href="http://moderndive.netlify.com/7-multiple-regression.html#model4residuals">here</a></li>
</ul>
<div id="residual-analysis-solutions" class="section level2">
<h2><span class="header-section-number">7.1</span> Residual Analysis Solutions</h2>
<p>Note: to change color of text in markdown plain text, use this command before your text: <code>&lt;span style=&quot;color:cadetblue&quot;&gt;</code> and this command at the end <code>&lt;/span&gt;</code>.</p>
<p><span style="color:cadetblue"> Residuals appear roughly unimodal, symmetric, and bell-shaped for both males and females. I don’t see any distinct patterns in the residuals for either sex, although in general, larger residuals seem to be more common among males than females, suggesting that the model may work better in terms of accurately predicting vitamin d levels among females compared to males. </span></p>
<pre class="r"><code>d_pts &lt;- get_regression_points(dmod)
ggplot(d_pts, aes(x = residual)) +
  geom_histogram(binwidth = 10, color = &quot;white&quot;) +
  labs(x = &quot;Residual&quot;) +
  facet_wrap(~sex)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-8-1.png" width="2100" /></p>
<pre class="r"><code>ggplot(d_pts, aes(x = age_ctr, y = residual)) +
  geom_point() +
  labs(x = &quot;age&quot;, y = &quot;Residual&quot;) +
  geom_hline(yintercept = 0, col = &quot;blue&quot;, size = 1) +
  facet_wrap(~ sex)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-9-1.png" width="2100" /></p>
<pre class="r"><code>ggplot(d_pts, aes(x = zhfa, y = residual)) +
  geom_point() +
  labs(x = &quot;age&quot;, y = &quot;Residual&quot;) +
  geom_hline(yintercept = 0, col = &quot;blue&quot;, size = 1) +
  facet_wrap(~ sex)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-10-1.png" width="2100" /></p>
</div>
</div>
<div id="outlier-analysis" class="section level1">
<h1><span class="header-section-number">8</span> Outlier Analysis</h1>
<p>Examine points with high leverage and discrepancy (use the externally studentized residuals as the index for discrepancy). Remember that these statistics are not in the output of the <code>moderndive::get_regression_points()</code> function- you’ll want to use <code>broom::augment()</code> instead.</p>
<ul>
<li>How many observations would you expect to have high discrepancy in this sample?
<ul>
<li>You may want to account for how many females versus males you would expect</li>
</ul></li>
<li>Do you see any observations that have <em>both</em> high leverage and discrepancy?</li>
<li>Do any points that are either high leverage or high discrepancy <strong>also</strong> have high influence on the regression estimates, as measured by Cook’s distance?</li>
<li>Would you exclude any observations from your model? Justify your answer either way.</li>
<li>In general, would you say the overall model fit is better for females or males? Why or why not?</li>
</ul>
<div id="outlier-analysis-solutions" class="section level2">
<h2><span class="header-section-number">8.1</span> Outlier Analysis Solutions</h2>
<pre class="r"><code>d_diag &lt;- augment(dmod, data = vitd) %&gt;% 
  mutate(.ext.resid = rstudent(dmod))

# leverage
k &lt;- 3
mean_hat &lt;- (k + 1)/nrow(small_vitd)
d_diag %&gt;% 
  select(id, .hat) %&gt;%
  filter(.hat &gt; (3*mean_hat))</code></pre>
<pre><code>    id       .hat
1  207 0.02472936
2  303 0.02937141
3  359 0.02991128
4  436 0.02808036
5  648 0.02241751
6  755 0.03662338
7  902 0.02593086
8  954 0.03903172
9 1053 0.02511987</code></pre>
<pre class="r"><code># discrepancy
d_diag %&gt;%
  filter(abs(.ext.resid) &gt;= 2) %&gt;%
  select(id, ageyears, .resid, .std.resid, .ext.resid) %&gt;% 
  arrange(desc(abs(.ext.resid)))</code></pre>
<pre><code>     id  ageyears    .resid .std.resid .ext.resid
1   616  8.822724  47.22766   3.509627   3.548228
2   156  8.269678 -46.47235  -3.460493  -3.497383
3   524  9.619439  46.12290   3.428426   3.464227
4   658 11.943870  43.84302   3.263728   3.294267
5   446  9.414100  41.42309   3.076571   3.101776
6   740  9.901437  37.69411   2.804681   2.823275
7   701  6.958248  36.83751   2.748425   2.765809
8   403  8.045175 -36.24964  -2.695624  -2.711919
9   850 10.887060  34.97146   2.600100   2.614539
10  158  9.474333  33.86881   2.513564   2.526442
11  148 11.467490 -32.64923  -2.429196  -2.440659
12 1054 13.017110 -32.29858  -2.416726  -2.427988
13  133  9.860370 -32.49099  -2.411642  -2.422823
14  241 11.092400 -32.20219  -2.393730  -2.404629
15  444 10.158800  32.20380   2.392914   2.403799
16  218  7.921971 -30.51524  -2.271308  -2.280393
17  656 12.373720  30.34874   2.265852   2.274860
18  550 11.363450 -29.95725  -2.226879  -2.235356
19  612  7.850787  29.67716   2.209275   2.217518
20  244 10.996580 -29.27397  -2.176115  -2.183928
21  439  9.685147  29.09661   2.162651   2.170294
22  229 10.128680 -28.80008  -2.148396  -2.155861
23 1014  8.715948  28.29069   2.102882   2.109796
24  708  7.722108  27.82986   2.073172   2.079740
25  243 10.988360 -27.61464  -2.055192  -2.061556
26 1033 11.141680  27.36183   2.032800   2.038914</code></pre>
<pre class="r"><code># leverage and discrepancy
d_diag %&gt;% 
  select(id, .hat, .ext.resid) %&gt;%
  filter(.hat &gt; (3*mean_hat) &amp; abs(.ext.resid) &gt;= 2)</code></pre>
<pre><code>[1] id         .hat       .ext.resid
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code># discrepancy by gender
d_diag %&gt;%
  filter(abs(.ext.resid) &gt;= 2) %&gt;%
  count(sex)</code></pre>
<pre><code># A tibble: 2 x 2
  sex       n
  &lt;chr&gt; &lt;int&gt;
1 F         7
2 M        19</code></pre>
<pre class="r"><code>n &lt;- nrow(small_vitd)
k &lt;- 3 # predictors (not including intercept)
d &lt;- 4/(n - k - 1)
d</code></pre>
<pre><code>[1] 0.00750469</code></pre>
<pre class="r"><code>d_diag %&gt;%
  filter(.cooksd &gt; d) %&gt;% 
  select(id, x25d, .cooksd) %&gt;% 
  arrange(desc(.cooksd))</code></pre>
<pre><code>     id  x25d     .cooksd
1   156  36.1 0.025541252
2  1054  46.6 0.023933215
3   701 113.0 0.022103136
4   658 124.0 0.021432904
5   524 125.0 0.016714035
6   656 109.0 0.016449111
7   616 127.0 0.016217442
8   740 116.0 0.014339336
9   229  41.8 0.013191057
10  755  58.4 0.012815041
11  348  84.3 0.011960428
12  403  36.9 0.011528463
13  204 103.0 0.011309589
14  704  50.0 0.011042363
15  148  46.6 0.010645525
16  446 121.0 0.010356668
17  850 114.0 0.010229443
18  218  50.2 0.010120106
19  708 108.0 0.009891891
20  612 105.0 0.009884597
21  217  55.9 0.008640295
22  860  57.3 0.008351111
23  241  49.6 0.008209918
24  916  56.5 0.008192610
25  427  78.1 0.008172130
26  243  50.9 0.008104123
27  901  52.3 0.007990439
28  639  39.8 0.007670300</code></pre>
<pre class="r"><code>ggplot(d_diag, aes(x = .hat, y = .cooksd, color = sex)) + 
  geom_point() +
  geom_text(aes(label = id), size = 3, vjust = 2) + 
  geom_hline(aes(yintercept = d), colour = &quot;red&quot;, lty = &quot;dashed&quot;) +
  geom_vline(aes(xintercept = 3*mean_hat), color = &quot;dodgerblue&quot;, lty = &quot;dashed&quot;)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-12-1.png" width="2100" /></p>
<pre class="r"><code>ggplot(d_diag, aes(x = .ext.resid, y = .cooksd, color = sex)) + 
  geom_point() +
  geom_text(aes(label = id), size = 3, vjust = 2) + 
  geom_hline(aes(yintercept = d), colour = &quot;red&quot;, lty = &quot;dashed&quot;) +
  geom_vline(xintercept = c(-2, 2), color = &quot;dodgerblue&quot;, lty = &quot;dashed&quot;)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-12-2.png" width="2100" /></p>
<ul style="color:cadetblue">
<ul>
<li>How many observations would you expect to have high discrepancy in this sample? You may want to account for how many females versus males you would expect.</li>
<li>DISCREPANCY: I expect 5% of observations to have high discrepancy, which is measured by externally studentized residuals, so I would expect generally <span class="math inline">\(.05 \times 529 = 26\)</span> observations to be high on this metric. Given the roughly equal sample sizes, this means I’d expect 13 high values for males and females. Instead, I see 7 females with high leverage, compared to 19 males. This is a pretty big difference, and suggests (as I observed with the unstandardized “raw” residuals), that the model may better explain variability in vitamind d levels for females than for males.</li>
<li>Do you see any observations that have <em>both</em> high leverage and discrepancy?</li>
<li>LEVERAGE: 9 observations with high leverage.</li>
<li>LEVERAGE + DISCREPANCY: 0 observations. Huzzah.</li>
<li>Do any points that are either high leverage or high discrepancy <strong>also</strong> have high influence on the regression estimates, as measured by Cook’s distance?</li>
<li>Yes! I do see one point with high leverage (<code>.hat</code>) and high cooks d values: 755 (a male)
<ul>
<li>Generally I see more green than pink above both cut-offs</li>
</ul></li>
<li>Same story comparing high discrepancy and cooks d values: a lot of points here, mainly green. 755 doesn’t show up as an extreme for discrepancy.</li>
<li>Would you exclude any observations from your model? Justify your answer either way.</li>
<li>There are a lot of “flags” here, but I would not exclude anyone! If I were a vitamin d researcher, I might want to find out what the range of biologically plausible values are for vitamin d levels generally, so that I might have an objective way to identify, for example, where lab testing of vitamin d levels went awry. But as is, I have no way to identify incorrect data from unusual data.</li>
<li>In general, would you say the overall model fit is better for females or males? Why or why not?</li>
<li>Across most metrics, the pattern suggests that the model explains variability in vitamin d levels better for females compared to males.</li>
</ul>
</ul>
</div>
</div>
<div id="sums-of-squares" class="section level1">
<h1><span class="header-section-number">9</span> Sums of Squares</h1>
<p>Fill in the blanks in the following code block to calculate the Residual, Model, and Total Sums of Squares:</p>
<pre class="r"><code>vitd_ss &lt;- d_diag %&gt;% 
  summarise(total_ss = sum((___ - mean(___))^2),
            resid_ss = sum((___ - ___)^2), 
            model_ss = sum((___ - mean(___))^2))
vitd_ss</code></pre>
<p>Using <code>dplyr</code>, show that:</p>
<ul>
<li>The total sums of squares is equal to the residual plus the model sums of squares</li>
</ul>
<p><span class="math display">\[\textrm{total_ss} = \textrm{resid_ss} + \textrm{model_ss}\]</span></p>
<ul>
<li>The total sums of squares divided by <span class="math inline">\((n-1)\)</span> is equal to the variance of the <code>y</code> outcome variable (<em>hint:</em> you may need to look how many observations actually contributed to the model- not the same as the original <span class="math inline">\(n\)</span> due to missing values!)</li>
</ul>
<p><span class="math display">\[var_y = \frac{\textrm{total_ss}}{n-1}\]</span></p>
<ul>
<li>The <span class="math inline">\(R^2\)</span> value in your model output is the model sums of squares divided by the total sums of squares (<em>hint:</em> <code>broom::glance(my_model)</code>).</li>
</ul>
<p><span class="math display">\[R^2 = \frac{\textrm{model_ss}}{\textrm{total_ss}}\]</span></p>
<div id="sums-of-squares-solutions" class="section level2">
<h2><span class="header-section-number">9.1</span> Sums of Squares Solutions</h2>
<pre class="r"><code>vitd_ss &lt;- d_diag %&gt;% 
  summarise(total_ss = sum((x25d - mean(x25d))^2),
            resid_ss = sum((x25d - .fitted)^2), 
            model_ss = sum((.fitted - mean(x25d))^2),
            total = resid_ss + model_ss,
            rsq = model_ss / total_ss,
            var_est = total_ss / (n()-1),
            vitd_var = var(x25d))
vitd_ss</code></pre>
<pre><code>  total_ss resid_ss model_ss    total       rsq  var_est vitd_var
1 125063.5 95510.65 29552.81 125063.5 0.2363025 236.8626 236.8626</code></pre>
<pre class="r"><code>glance(dmod)</code></pre>
<pre><code>  r.squared adj.r.squared    sigma statistic      p.value df    logLik
1 0.2363025     0.2304728 13.50082  40.53389 1.330837e-29  5 -2124.962
       AIC      BIC deviance df.residual
1 4261.923 4287.549 95510.65         524</code></pre>
</div>
</div>
<div id="the-null-model" class="section level1">
<h1><span class="header-section-number">10</span> The NULL Model</h1>
<p>In class, I asserted that <code>lm</code> is by default comparing the model you specify in your <code>lm</code> call to a null model defined by using a line with an intercept but slope = 0, which estimates the mean of <span class="math inline">\(y\)</span>. Let’s build an intercept-only linear regression model to prove this.</p>
<pre class="r"><code>vitd_complete &lt;- small_vitd %&gt;% 
  drop_na(x25d, sex, ageyears, zhfa)
int_mod &lt;- lm(x25d ~ 1, data = vitd_complete)
get_regression_table(int_mod)</code></pre>
<pre><code># A tibble: 1 x 7
  term      estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept     74.3     0.669      111.       0     73.0     75.6</code></pre>
<p>What is the “estimate” equal to here (<strong>hint:</strong> look back at your <code>skim</code> output)?</p>
<pre class="r"><code>anova(int_mod, dmod) # insert your model name from above instead of &quot;dmod&quot;</code></pre>
<pre><code>Analysis of Variance Table

Model 1: x25d ~ 1
Model 2: x25d ~ age_ctr * sex + zhfa
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    528 125063                                  
2    524  95511  4     29553 40.534 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Use the code above to use the <code>anova</code> function to compare the intercept-only model to your linear regresssion model. Look very carefully at this output and answer these questions:</p>
<ul>
<li>What is the <code>RSS</code> for line 1 (corresponding to the intercept-only model, Model 1) equal to that you calculated above?</li>
<li>What is the <code>RSS</code> for line 2 (corresponding to Model 2) equal to that you calculated above?</li>
<li>What is the <code>Sum of Sq</code> equal to that you calculated above?</li>
<li>In &lt; 3 sentences, explain what it means to use <code>lm(y ~ x + z)</code> versus <code>lm(y ~ 1)</code>, and what happens “under the hood” here that you now see in the <code>anova</code> output.</li>
</ul>
<div id="null-model-solutions" class="section level2">
<h2><span class="header-section-number">10.1</span> NULL Model Solutions</h2>
<ul style="color:cadetblue">
<ul>
<li>What is the “estimate” equal to here (hint: look back at your skim output)?
<ul>
<li>The mean, <span class="math inline">\(\bar{x}_{x25d}\)</span>, of vitamin d levels across the full sample</li>
</ul></li>
<li>What is the <code>RSS</code> for line 1 (corresponding to the intercept-only model, Model 1) equal to that you calculated above?
<ul>
<li>The total sums of squares, 125063</li>
</ul></li>
<li>What is the <code>RSS</code> for line 2 (corresponding to Model 2) equal to that you calculated above?
<ul>
<li>The residual sums of squares, 95511</li>
</ul></li>
<li>What is the <code>Sum of Sq</code> equal to that you calculated above?
<ul>
<li>The model sums of squares, 29553</li>
</ul></li>
<li>In &lt; 3 sentences, explain what it means to use <code>lm(y ~ x + z)</code> versus <code>lm(y ~ 1)</code>, and what happens “under the hood” here that you now see in the <code>anova</code> output.
<ul>
<li><code>lm</code> compares the model I entered (model 2) to an intercept-only model (model 1)- it estimates the fit of model 2 in minimizing the residual sums of squares, and compares that to what is left over or residual after using the mean vitamin d level across all children to predict individual vitamin d levels for each child (model 1). The <span class="math inline">\(R^2\)</span> for my model was 0.24, which is the ratio of the model sums of squares to the total sums of squares. That is the same as calculating:</li>
</ul></li>
</ul>
<span class="math display">\[1 - \frac{\textrm{Model2}~RSS}{\textrm{Model1}~RSS} = 1 - \frac{95561}{125063} = .236\]</span> - added intrepretation not needed but provided here: if the two models were equivalent this number would be <span class="math inline">\(1-1 = 0\)</span>. Model 2 always has to perform as least as well as Model 1 (it is not possible to be worse!). You can think of the ratio as 1 minus the proportion of variation “left over” by the null model (model 1) that can be explained by model 2.
</ul>
</div>
</div>
<div id="replicate-a-plot" class="section level1">
<h1><span class="header-section-number">11</span> Replicate a Plot</h1>
<p>In the <a href="https://dx.doi.org/10.1371%2Fjournal.pone.0104825">original paper</a>, they presented this figure:</p>
<p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4128742/bin/pone.0104825.g001.jpg" /> <br> Figure 1 Relation between age in years and serum 25-hydroxyvitamin D (nmol/L) concentrations stratified by gender. <br> Look at the published figure carefully:</p>
<ul>
<li>What appears to be the minimum value of serum 25D levels?</li>
<li>What appears to be the max?</li>
<li>Do those match your EDA?</li>
<li>Recreate this figure in <code>ggplot2</code> using the observed data (ignore height-for-age z-scores at this point).</li>
<li>Make the same plot where the y-axis should now be mapped to the fitted value for the outcome variable (using the full model with height-for-age z-scores in it). Discuss the differences you see between this plot and the previous. Were you able to recreate the published figure? Is it helpful in understanding the researchers’ findings? Was it misleading at all?</li>
</ul>
<div id="replicate-a-plot-solutions" class="section level2">
<h2><span class="header-section-number">11.1</span> Replicate a Plot Solutions</h2>
<p><span style="color:cadetblue"> I’ll leave the straight-forward answers as a given- they don’t match the EDA, we are definitely looking at a plot of fitted values, not the original data. It may have been helpful to put that in the figure legend. The plot is helpful for visualizing the results of the regression analyses, but clarifying that the points were fitted including other variables in the model not pictured (here, <code>zhfa</code>) would have made it more reproducible and potentially less misleading. Even then though, there looks to be less variability in their fitted values (especially for males)- I’m honestly not sure how they <em>actually</em> made this plot! </span></p>
<pre class="r"><code>ggplot(d_pts, aes(x = age_ctr, 
                 y = x25d,
                 color = sex)) +
  geom_point(alpha = .5)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-16-1.png" width="2100" /></p>
<pre class="r"><code>ggplot(d_pts, aes(x = age_ctr, 
                 y = x25d_hat,
                 color = sex)) +
  geom_point(alpha = .5)</code></pre>
<p><img src="cm026-solutions_files/figure-html/unnamed-chunk-17-1.png" width="2100" /></p>
</div>
</div>
<div id="report-your-process" class="section level1">
<h1><span class="header-section-number">12</span> Report your process</h1>
<p>You’re encouraged to reflect on what was hard/easy, problems you solved, helpful tutorials you read, etc. Give credit to your sources, whether it’s a blog post, a fellow student, an online tutorial, etc.</p>
</div>
<div id="grading" class="section level1">
<h1><span class="header-section-number">13</span> Grading</h1>
<p>This lab is worth 5 points total, scored as follows:</p>
<p>2 points for your initial submission being “in-good-faith”:</p>
<ul>
<li><p>2 (Strong attempt): narrative and code reflects strong independent problem solving, with clearly thought out attempts to approach the problems and a diligent and honest effort to find solutions.</p></li>
<li><p>1 (Adequate attempt): narrative and code reflects some attempt to approach the problems, but approach appears to be superficial and lacks depth of analysis.</p></li>
<li><p>0 (No attempt or incomplete): No submission, or didn’t interpret anything but left it all to the “reader”. Or more than one technical problem that is relatively easy to fix.</p></li>
</ul>
<p>3 points for the quality of the final self-assessment:</p>
<ul>
<li><p>3 (Exceptional): narrative is thorough, concise, and clearly demonstrates ability to analyze and interpret statistics as well as theoretical understanding of statistical concepts.</p></li>
<li><p>2 (Adequate): narrative addresses the questions with moderate inaccuracies in analysis and/or interpretation, or offers correct but incomplete solutions.</p></li>
<li><p>1 (Inadequate): narrative attempts to address questions with substantial inaccuracies in analysis and/or interpretation.</p></li>
<li><p>0 (Insufficient): narrative does not attempt to address questions or self-assessment is insufficient to grade</p></li>
</ul>
</div>

<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="by-nc.png" height="400" width="65"/></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
